<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LEMA Beauty</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Chiron+Sung+HK:ital,wght@0,200..900;1,200..900&family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" 
  rel="stylesheet">
  <link rel="stylesheet" href="css/beispiel-style.css" />
</head>

<body>
  <header>
    <div class="logo">
      <img src="img/logo.png" alt="Firmenlogo">
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Start</a></li>
        <li><a href="leistungen.html">Leistungen</a></li>
        <li><a href="kontakt.html">Kontakt</a></li>
      </ul>
    </nav>
  </header>


<main>
  <h1>Vielen Dank für Ihre Buchung!</h1>

  <!-- Fehlerbox unsichtbar) -->
  <div id="bookingError" role="alert" style="display:none; margin-top:16px; padding:12px; border-radius:10px; background:#ffe6e6;">
    <strong>Hinweis:</strong> <span id="bookingErrorText"></span>
  </div>

  <!-- Details -->
  <section id="bookingDetails">
    <h2>Ihre Buchungsdetails</h2>
    <p><strong>Name:</strong> <span id="fullname"></span></p>
    <p><strong>E-Mail:</strong> <span id="email"></span></p>
    <p><strong>Telefon:</strong> <span id="telefon"></span></p>
    <p><strong>Datum:</strong> <span id="datum"></span></p>
    <p><strong>Uhrzeit:</strong> <span id="uhrzeit"></span></p>
    <p><strong>Dauer:</strong> <span id="dauer"></span> Minuten</p>
    <p><strong>Leistung:</strong> <span id="leistung"></span></p>
    <p><strong>Preis:</strong> <span id="preis"></span> €</p>
  </section>
</main>





<footer>
  <div class="footer-content">
    <p>LEMA Beauty / Königstraße 1 / 70173 Stuttgart</p>
    <p>Tel: 0711 1234567 / <a href="impressum.html">Impressum</a></p>
    <p>&copy; 2025 made by LEMA</p>
    </div>
  </footer>


<script>
function showError(message) {
  const box = document.getElementById("bookingError");
  const text = document.getElementById("bookingErrorText");
  const details = document.getElementById("bookingDetails");

  text.textContent = message;
  box.style.display = "block";
  details.style.display = "none";
}

async function loadBooking() {
  const params = new URLSearchParams(window.location.search);
  const id = params.get("bookingId");

  if (!id) {
    showError("Keine Buchungs-ID angegeben. Bitte prüfen Sie den Link.");
    return;
  }

  try {
    const response = await fetch("http://localhost:8000/api/booking/" + encodeURIComponent(id));

    // JSON robust lesen (auch bei Fehlerantworten)
    const data = await response.json().catch(() => null);

    if (!response.ok) {
      const msg = (data && data.error) ? data.error : "Buchung nicht gefunden.";
      showError(msg);
      return;
    }

    document.getElementById("fullname").textContent = (data.vorname || "") + " " + (data.nachname || "");
    document.getElementById("email").textContent = data.email || "-";
    document.getElementById("telefon").textContent = (data.telefon && data.telefon.trim()) ? data.telefon : "-";
    document.getElementById("datum").textContent = data.datum || "-";
    document.getElementById("uhrzeit").textContent = data.uhrzeit || "-";
    document.getElementById("dauer").textContent = data.dauer ?? "-";
    document.getElementById("leistung").textContent = data.leistung || "-";
    document.getElementById("preis").textContent = data.preis ?? "-";

  } catch (error) {
    console.error(error);
    showError("Fehler beim Laden der Buchung. Bitte versuchen Sie es später erneut.");
  }
}

document.addEventListener("DOMContentLoaded", loadBooking);
</script>
  
</body>
</html>